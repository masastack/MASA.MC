@inherits AdminCompontentBase

<MAutocomplete Value="Value"
               ValueChanged="HandleValueChanged"
               TValue="List<Guid>"
               TItem="MessageTaskReceiverDto"
               TItemValue="Guid"
               OnSearchInputUpdate=OnSearchChanged
               Items="Items"
               Color="primary"
               Label="@T("Search")"
               ItemText="u=>TextView(u)"
               ItemValue="u=>u.SubjectId"
               Filter="(item,search,value) => true"
               Flat
               Dense
               Solo
               BackgroundColor="fill-lighten-1"
               HideDetails="@("auto")"
               Style="@($"width:340px;height:40px;{Style}")"
               Class="@($"{Class} rounded-2")"
               Multiple>
    <PrependInnerContent>
        <MIcon Size=16 Class="mr-2 default-lighten-1--text">mdi-magnify</MIcon>
    </PrependInnerContent>
    <ItemContent Context="data">
        <div class="d-flex" style="height:48px;">
            @if (data.Item.Type != MessageTaskReceiverTypes.User)
            {
                <MIcon Size=30>mdi-account-group</MIcon>
            }
            else
            {
                @if (string.IsNullOrEmpty(data.Item.Avatar))
                {
                    <EmptyAvatar Class="ma-auto" Size=30 Value="@(data.Item.DisplayName)" />
                }
                else
                {
                    <MAvatar Size=30 Class="ma-auto">
                        <img src="@data.Item.Avatar" />
                    </MAvatar>
                }
            }
            
            <div class="ma-auto ml-2">
                <div class="d-flex">
                    <span class="text-btn default-lighten-1--text">@(data.Item.Type == MessageTaskReceiverTypes.User?data.Item.DisplayName:T($"DisplayName.MessageTaskReceiverTypes.{data.Item.Type}"))</span>
                    @if (!string.IsNullOrEmpty(data.Item.DisplayName) && !string.IsNullOrEmpty(data.Item.PhoneNumber))
                    {
                        <div class="my-auto mx-2 divider-vertical-2"></div>
                    }
                    <span class="text-btn default-lighten-1--text">@data.Item.PhoneNumber</span>
                </div>
                <div class="d-flex">
                    <span class="text-overline" style="text-transform: none !important;">@data.Item.DisplayName</span>
                    @if (!string.IsNullOrEmpty(data.Item.DisplayName) && !string.IsNullOrEmpty(data.Item.Email))
                    {
                        <div class="my-auto mx-2 divider-vertical-2"></div>
                    }
                    <span class="text-overline" style="text-transform: none !important;">@data.Item.Email</span>
                </div>
            </div>
        </div>
    </ItemContent>
</MAutocomplete>